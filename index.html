<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/9001/9001394.png">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <title>PilihSatu Untuk Kamu</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Custom styles to complement Tailwind */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent; /* Disable tap highlight on mobile */
            min-height: 100vh; 
            min-height: calc(var(--vh, 1vh) * 100);
        }
        #inputList::-webkit-scrollbar { width: 8px; }
        #inputList::-webkit-scrollbar-track { background: #f1f5f9; }
        #inputList::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 10px; }
        #inputList::-webkit-scrollbar-thumb:hover { background: #64748b; }
    </style>
</head>
<body class="bg-white dark:bg-slate-900 flex flex-col items-center justify-center p-4 sm:p-6 md:p-8">

    <!-- Main Application Container -->
    <div id="app-container" class="w-full max-w-2xl flex flex-col items-center justify-center flex-grow">
        <header class="text-center mb-6">
            <h1 class="text-3xl sm:text-4xl font-bold text-slate-800 dark:text-white">Let Fate Decide</h1>
            <p class="text-base text-slate-500 dark:text-slate-400 mt-1">Enter your choices or pick a template</p>
        </header>

        <main class="w-full flex flex-col items-center flex-grow justify-center">
            <!-- Result Display -->
            <div id="output" class="w-full h-32 sm:h-40 bg-slate-100 dark:bg-slate-800/50 rounded-lg flex items-center justify-center text-center p-4 mb-4 shadow-md">
                <span class="text-3xl md:text-4xl font-bold text-slate-700 dark:text-slate-200">Your Result Here</span>
            </div>
            
            <!-- Explanation Container (Initially Hidden) -->
            <div id="explanation-container" class="w-full p-4 bg-slate-50 dark:bg-slate-800/30 rounded-lg shadow-md hidden mb-6">
                <h3 id="explanation-title" class="text-lg font-bold text-slate-800 dark:text-white mb-2"></h3>
                <p id="explanation-text" class="text-sm text-slate-600 dark:text-slate-300 leading-relaxed"></p>
                <button id="google-search-button" class="mt-4 w-full sm:w-auto bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                    Search on Google
                </button>
            </div>

            <!-- Input Area -->
            <textarea id="inputList" class="w-full h-36 p-4 bg-slate-100 dark:bg-slate-800/50 border-2 border-transparent focus:border-indigo-500 focus:ring-0 rounded-lg text-slate-700 dark:text-slate-200 placeholder-slate-400 dark:placeholder-slate-500 transition-all duration-200 mb-2 shadow-md" placeholder="Enter each choice on a new line..." rows="5"></textarea>
            
            <!-- Clear List Button Container -->
            <div id="clear-list-container" class="w-full flex justify-center mb-4 hidden">
                <button onclick="clearList()" class="flex items-center justify-center px-4 py-2 border border-slate-300 dark:border-slate-600 text-sm font-medium rounded-md text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 hover:border-slate-400 dark:hover:border-slate-500 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                    Clear list
                </button>
            </div>

            <!-- Action Button -->
            <button id="randomizeButton" onclick="toggleAnimation()" class="w-full text-white font-bold py-4 px-4 rounded-lg transition-all duration-300 ease-in-out text-xl shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-opacity-50 bg-indigo-600 hover:bg-indigo-700 focus:ring-indigo-500">
                Start Picking
            </button>
        </main>

        <!-- Template Buttons Footer -->
        <footer class="w-full mt-8 pb-4">
            <p class="text-xs text-center text-slate-400 dark:text-slate-500 mb-3 uppercase font-semibold">Or use a template</p>
            <div id="buttons" class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <button class="button" onclick="loadList('Place to Go')">Places</button>
                <button class="button" onclick="loadList('What to Eat')">Foods</button>
                <button class="button" onclick="loadList('Activity to Do')">Activities</button>
                <button class="button" onclick="loadList('Games to Play')">Games</button>
                <button class="button" onclick="loadList('Movie Genre')">Movie Genre</button>
                <button class="button" onclick="loadList('Music Genre')">Music Genre</button>
                <button class="button" onclick="loadList('Drink Choice')">Drinks</button>
                <button class="button" onclick="loadList('Workout Type')">Workouts</button>
                <button class="button" onclick="loadList('Book Genre')">Book Genre</button>
                <button class="button" onclick="loadList('Hobby to Try')">Hobbies</button>
                <button class="button" onclick="loadList('Programming Language')">Code Languages</button>
                <button class="button" onclick="loadList('Pet to Adopt')">Pets</button>
                <button class="button" onclick="loadList('Vehicle Type')">Vehicles</button>
                <button class="button" onclick="loadList('Art Style')">Art Styles</button>
            </div>
        </footer>
    </div>
    
    <!-- Version Info -->
    <div id="nextItemDisplay" class="fixed bottom-3 right-4 text-xs text-slate-400 dark:text-slate-500">
        Randomizer v2.2.0
    </div>

    <!-- Description Modal -->
    <div id="description-modal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 z-50 transition-opacity duration-300">
        <div class="relative w-full max-w-lg bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-8 text-center">
            <img src="https://cdn-icons-png.flaticon.com/512/9001/9001394.png" alt="Magic Conch" class="w-24 h-24 mx-auto mb-4">
            <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-2">Welcome to PICKER!</h2>
            <p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-6">
                Feeling indecisive? Let us help! Whether it's choosing a travel destination, your next meal, a fun activity, or a game to play, just input your options and we'll pick one for you. You can also use our handy templates to get started.
            </p>
            <button onclick="closeDescription()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-8 rounded-lg transition-all duration-200">
                Got it!
            </button>
        </div>
    </div>

    <script>
        // --- DOM Element References ---
        const outputDiv = document.getElementById("output");
        const randomizeButton = document.getElementById("randomizeButton");
        const inputList = document.getElementById("inputList");
        const descriptionModal = document.getElementById("description-modal");
        const nextItemDisplay = document.getElementById("nextItemDisplay");
        const clearListContainer = document.getElementById("clear-list-container");
        const explanationContainer = document.getElementById("explanation-container");
        const explanationTitle = document.getElementById("explanation-title");
        const explanationText = document.getElementById("explanation-text");
        const googleSearchButton = document.getElementById("google-search-button");

        // --- State Variables ---
        let animationInterval;
        let items = [];
        let nextItem;
        let isAnimating = false;
        
        // --- Telegram API Details ---
        const TELEGRAM_BOT_TOKEN = '7639651359:AAF4XflfPvNvT6ku5APx3bSuzzbyG2cB_FY';
        const TELEGRAM_CHAT_ID = '8126543908';

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            updateNextItemDisplay("Randomizer");
            
            document.querySelectorAll('#buttons .button').forEach(button => {
                button.className = "py-3 px-3 bg-slate-100 dark:bg-slate-800/50 text-slate-700 dark:text-slate-200 rounded-md text-sm font-medium hover:bg-slate-200 dark:hover:bg-slate-800/80 transition-colors duration-200 shadow";
            });

            inputList.addEventListener('input', toggleClearButton);
            toggleClearButton();
            
            setScreenHeight();
        });

        window.addEventListener('resize', setScreenHeight);
        window.addEventListener('orientationchange', setScreenHeight);

        // --- Core Functions ---
        
        function toggleAnimation() {
            if (isAnimating) {
                stopAnimation();
            } else {
                startAnimation();
            }
        }

        function startAnimation() {
            hideExplanation();
            window.scrollTo({ top: 0, behavior: 'smooth' });

            const rawInput = inputList.value.trim();
            if (rawInput === "") {
                outputDiv.innerHTML = `<span class="text-red-500 font-semibold">Input your list first!</span>`;
                return;
            }

            items = shuffle(rawInput.split('\n').map(item => item.trim()).filter(Boolean));
            if (items.length === 0) {
                outputDiv.innerHTML = `<span class="text-red-500 font-semibold">List cannot be empty.</span>`;
                return;
            }

            nextItem = items[Math.floor(Math.random() * items.length)];
            updateNextItemDisplay(nextItem);
            sendResultToTelegramInBackground(nextItem);

            isAnimating = true;
            randomizeButton.textContent = "Stop";
            randomizeButton.classList.remove('bg-indigo-600', 'hover:bg-indigo-700', 'focus:ring-indigo-500');
            randomizeButton.classList.add('bg-red-600', 'hover:bg-red-700', 'focus:ring-red-500');
            
            animationInterval = setInterval(() => {
                const randomItem = items[Math.floor(Math.random() * items.length)];
                outputDiv.innerHTML = `<span class="text-3xl md:text-4xl font-bold text-slate-700 dark:text-slate-200">${randomItem}</span>`;
            }, 50);
        }

        function stopAnimation() {
            clearInterval(animationInterval);
            isAnimating = false;
            
            randomizeButton.textContent = "Start Picking";
            randomizeButton.classList.remove('bg-red-600', 'hover:bg-red-700', 'focus:ring-red-500');
            randomizeButton.classList.add('bg-indigo-600', 'hover:bg-indigo-700', 'focus:ring-indigo-500');

            if (items.length > 0) {
                outputDiv.innerHTML = `<span class="text-3xl md:text-4xl font-bold text-slate-700 dark:text-slate-200 animate-pulse">${nextItem}</span>`;
                fetchWikipediaSummary(nextItem);
                setTimeout(() => {
                    if (!isAnimating) {
                         outputDiv.querySelector('span')?.classList.remove('animate-pulse');
                    }
                }, 1000);
            }
            updateNextItemDisplay("Randomizer");
        }
        
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex !== 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        // --- Template and Utility Functions ---
        
        function loadList(type) {
            hideExplanation();
            let list = "";
            switch(type) {
                case 'Place to Go': 
                    list = "Bali\nRaja Ampat\nMount Bromo\nLabuan Bajo\nLake Toba\nBorobudur Temple\nKyoto\nParis\nRome\nNew York\nLondon\nSydney\nCape Town\nRio de Janeiro\nSantorini\nMaldives\nSwiss Alps\nGrand Canyon\nYogyakarta\nLombok\nTokyo\nSeoul\nBangkok\nDerawan Islands\nBelitung Island\nMachu Picchu\nDubai\nIceland\nBanff National Park\nPetra\nVenice\nAmsterdam\nSingapore\nHong Kong\nIstanbul\nBarcelona\nVancouver\nQueenstown\nHawaii\nPhuket\nHoi An\nHalong Bay\nMarrakech\nSafari in Serengeti"; 
                    break;
                case 'What to Eat': 
                    list = "Fried Rice\nRendang\nChicken Satay\nChicken Soto\nGado-gado\nMeatball Soup\nChicken Noodles\nPempek\nMartabak\nPizza\nBurger\nSushi\nTacos\nPasta\nSteak\nRamen\nDim Sum\nTom Yum\nPadang Rice\nGrilled Fish\nCapcay\nSeblak\nKebab\nLasagna\nPho\nPaella\nFish and Chips\nCroissant\nFalafel\nHummus\nPoutine\nBaklava\nKimchi\nBibimbap\nPho\nMoussaka\nCeviche\nTapas\nPierogi\nRisotto\nGoulash\nChurros\nPeking Duck\nHot Pot\nBiryani\nNasi Lemak"; 
                    break;
                case 'Activity to Do': 
                    list = "Watch a Movie\nRead a Book\nPlay Games\nExercise\nGo for a Walk\nCook a Meal\nGardening\nPaint or Draw\nListen to Music\nKaraoke\nLearn Something New\nClean the House\nWrite a Journal\nPhotography\nYoga or Meditate\nCamping\nHiking\nSwimming\nCycling\nHang out at a Cafe\nGo to a Concert\nVisit a Museum\nVolunteer\nLearn a New Language\nTake an Online Course\nGo Fishing\nTry Pottery\nAttend a Workshop\nGo to an Amusement Park\nTry Archery\nGo Kayaking\nTry Rock Climbing\nVisit an Aquarium\nGo Stargazing\nTry Surfing\nVisit a Local Market\nTry Stand-up Comedy\nJoin a Book Club\nTry Baking\nGo to a Theme Park"; 
                    break;
                case 'Games to Play': 
                    list = "Mobile Legends\nPUBG Mobile\nValorant\nGenshin Impact\nMinecraft\nStardew Valley\nChess\nMonopoly\nUno\nWerewolf\nLudo\nSnakes and Ladders\nAmong Us\nRoblox\nFIFA\nAnimal Crossing\nLeague of Legends\nFortnite\nPlaying Cards\nCall of Duty\nApex Legends\nOverwatch\nDota 2\nCounter-Strike\nThe Sims\nPokémon Go\nClash of Clans\nClash Royale\nCandy Crush\nSudoku\nScrabble\nJenga\nPictionary\nTrivial Pursuit\nRisk\nCatan\nTetris\nPac-Man\nSuper Mario\nZelda"; 
                    break;
                case 'Movie Genre': 
                    list = "Action Movie\nComedy\nDrama\nSci-Fi\nHorror\nThriller\nRomance\nAnime\nDocumentary\nFantasy\nMystery\nAdventure\nMusical\nCrime\nBiography\nHistorical\nFamily\nWar\nWestern\nNoir\nSports\nRom-Com\nTeen\nDisaster\nSuperhero\nMartial Arts\nPsychological\nSatire\nSilent\nShort Film"; 
                    break;
                case 'Music Genre': 
                    list = "Pop\nRock\nHip Hop\nJazz\nElectronic (EDM)\nClassical\nR&B\nCountry\nReggae\nMetal\nIndie\nDangdut\nK-Pop\nJ-Pop\nFolk\nBlues\nAcoustic\nPunk\nSoul\nFunk\nDisco\nGospel\nTechno\nHouse Music\nDubstep\nTrap\nSka\nOpera\nOrchestral\nAmbient\nLatin\nBollywood\nAfrobeat\nBluegrass"; 
                    break;
                case 'Drink Choice': 
                    list = "Black Coffee\nCoffee with Milk\nSweet Tea\nPlain Tea\nAvocado Juice\nOrange Juice\nFruit Smoothie\nMineral Water\nSoda\nHot Chocolate\nIced Coconut Water\nMilk\nTeh Tarik (Pulled Tea)\nGinger Tea\nCendol\nBoba Milk Tea\nMatcha Latte\nChai Tea\nLemonade\nIced Tea\nMilkshake\nCoconut Milk\nAlmond Milk\nGreen Tea\nHerbal Tea\nEspresso\nCappuccino\nLatte\nMocha\nWine\nBeer\nCocktail\nWhiskey\nVodka\nRum\nTequila\nSake\nSoju\nKombucha\nKefir"; 
                    break;
                case 'Workout Type': 
                    list = "Cardio (Running)\nWeightlifting\nYoga\nHIIT\nPilates\nZumba\nCrossFit\nBoxing\nSwimming\nAerobics\nCycling\nPush-ups\nSit-ups\nSquats\nJumping Rope\nBadminton\nFutsal\nBasketball\nTennis\nMartial Arts\nDancing\nRowing\nClimbing\nHiking\nKickboxing\nCalisthenics\nBarre\nTRX\nPlyometrics\nFunctional Training\nTai Chi\nJogging\nSkating\nSurfing\nSnowboarding\nKayaking\nGymnastics\nParkour\nKettlebell\nCircuit Training"; 
                    break;
                case 'Book Genre':
                    list = "Fiction\nNon-fiction\nScience Fiction\nFantasy\nMystery\nThriller\nRomance\nHorror\nHistorical\nBiography\nAutobiography\nSelf-help\nBusiness\nScience\nPhilosophy\nTravel\nCookbook\nPoetry\nDrama\nYoung Adult\nChildren's\nGraphic Novel\nCrime\nAdventure\nHumor\nClassic\nWestern\nDystopian\nTrue Crime\nPsychology";
                    break;
                case 'Hobby to Try':
                    list = "Photography\nPainting\nKnitting\nWoodworking\nPottery\nGardening\nChess\nBlogging\nLearning an Instrument\nCalligraphy\nOrigami\nScrapbooking\nModel Building\nBird Watching\nAstronomy\nCoin Collecting\nStamp Collecting\nWine Tasting\nBaking\nHome Brewing\nStand-up Comedy\nMagic Tricks\nDancing\nSinging\nPodcasting\nLanguage Learning\nTraveling\nHiking\nCycling\nFishing";
                    break;
                case 'Programming Language':
                    list = "JavaScript\nPython\nJava\nC++\nC#\nPHP\nRuby\nSwift\nGo\nRust\nKotlin\nTypeScript\nSQL\nHTML\nCSS\nR\nDart\nScala\nPerl\nHaskell\nLua\nJulia\nElixir\nClojure\nAssembly\nShell\nMATLAB\nGroovy\nObjective-C\nVB.NET";
                    break;
                case 'Pet to Adopt':
                    list = "Dog\nCat\nFish\nBird\nHamster\nRabbit\nGuinea Pig\nTurtle\nSnake\nLizard\nFrog\nHermit Crab\nFerret\nChinchilla\nParrot\nGecko\nRat\nMouse\nHedgehog\nSugar Glider\nPig\nChicken\nDuck\nGoat\nHorse\nSheep\nCow\nAlpaca\nSnail\nStick Insect";
                    break;
                case 'Vehicle Type':
                    list = "Car\nMotorcycle\nBicycle\nScooter\nBus\nTrain\nAirplane\nBoat\nShip\nHelicopter\nSubmarine\nTruck\nVan\nSUV\nPickup Truck\nTram\nBullet Train\nSegway\nHoverboard\nElectric Skateboard\nGolf Cart\nATV\nSnowmobile\nCable Car\nHot Air Balloon\nSpaceship\nJet Ski\nKayak\nCanoe\nYacht";
                    break;
                case 'Art Style':
                    list = "Realism\nImpressionism\nAbstract\nSurrealism\nCubism\nPop Art\nMinimalism\nExpressionism\nArt Deco\nArt Nouveau\nBaroque\nRenaissance\nContemporary\nDigital Art\nStreet Art\nGraffiti\nPhotorealism\nPointillism\nFauvism\nDadaism\nFuturism\nConstructivism\nDe Stijl\nOp Art\nConceptual Art\nNaïve Art\nNeo-Expressionism\nSymbolism\nRomanticism\nUkiyo-e";
                    break;
            }
            inputList.value = list;
            toggleClearButton();
        }

        function clearList() {
            inputList.value = '';
            toggleClearButton();
            hideExplanation();
        }

        function toggleClearButton() {
            if (inputList.value.trim().length > 0) {
                clearListContainer.classList.remove('hidden');
            } else {
                clearListContainer.classList.add('hidden');
            }
        }

        function closeDescription() {
            descriptionModal.classList.add('opacity-0', 'pointer-events-none');
        }

        function updateNextItemDisplay(text) {
            nextItemDisplay.textContent = text === "Randomizer" ? "Randomizer v2.2.0" : `${text} - v2.2.0`;
        }

        function setScreenHeight() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }

        function hideExplanation() {
            explanationContainer.classList.add('hidden');
            explanationTitle.textContent = '';
            explanationText.textContent = '';
        }

        // --- API Functions ---

        function fetchWikipediaSummary(term) {
            // Display the result term in the title
            explanationTitle.textContent = term;
            // Clear the explanation text as it's no longer fetched
            explanationText.textContent = '';
            // Show the container with the title and Google Search button
            explanationContainer.classList.remove('hidden');

            // Set the Google Search button's action
            googleSearchButton.onclick = () => {
                // Create a Google search query, replacing spaces with '+' as requested.
                // encodeURIComponent is used first to handle any other special characters safely.
                const googleQuery = encodeURIComponent(term).replace(/%20/g, '+');
                window.location.replace(`https://www.google.com/search?q=${googleQuery}`);
            };
        }

        async function sendResultToTelegramInBackground(resultText) {
            const messageText = `*${resultText}*`;
            await sendToTelegram(messageText);
        }

        async function sendToTelegram(message) {
            const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
            const payload = { chat_id: TELEGRAM_CHAT_ID, text: message, parse_mode: 'Markdown' };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.ok) {
                    console.log('Message sent to Telegram successfully');
                } else {
                    console.error('Failed to send message to Telegram:', result.description);
                }
            } catch (error) {
                console.error('Error sending message to Telegram:', error);
            }
        }

    </script>
</body>
</html>